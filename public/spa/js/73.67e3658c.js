"use strict";(globalThis["webpackChunktdp_ui"]=globalThis["webpackChunktdp_ui"]||[]).push([[73],{8073:(e,l,a)=>{a.r(l),a.d(l,{default:()=>pe});var o=a(9835),n=a(499),t=a(9302),i=a(6970),s=a(4182),r=a(5575),c=a(1569);const d=e=>((0,o.dD)("data-v-0cfa3fbc"),e=e(),(0,o.Cn)(),e),u={class:"row no-wrap items-center q-pa-sm q-gutter-xs"},p={class:"col q-px-sm"},m=d((()=>(0,o._)("div",{class:"q-uploader__title"},"Upload Files",-1))),g={class:"q-uploader__subtitle"},f={__name:"filesUploader",setup(e){const l=(0,t.Z)(),{dialogRef:a,onDialogOK:d,onDialogCancel:f}=(0,s.Z)(),w=()=>`${c.addr}/api/files/upload`,_=e=>{l.notify({type:"negative",message:`${e.length} file(s) did not pass validation constraints`})};return(e,l)=>{const t=(0,o.up)("q-btn"),s=(0,o.up)("q-spinner"),c=(0,o.up)("q-uploader-add-trigger"),f=(0,o.up)("q-uploader"),k=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(k,{ref_key:"dialogRef",ref:a,persistent:""},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{class:"uploader",multiple:"",url:w,"field-name":e=>encodeURIComponent(e.name),color:"blue-grey-8",accept:".mkv,image/*, video/*, audio/*",onRejected:_},{header:(0,o.w5)((e=>[(0,o._)("div",u,[e.queuedFiles.length>0?((0,o.wg)(),(0,o.j4)(t,{key:0,round:"",dense:"",flat:"",icon:"clear_all",onClick:e.removeQueuedFiles},{default:(0,o.w5)((()=>[(0,o.Wm)((0,n.SU)(r.Z),{msg:"Clear All"})])),_:2},1032,["onClick"])):(0,o.kq)("",!0),e.uploadedFiles.length>0?((0,o.wg)(),(0,o.j4)(t,{key:1,round:"",dense:"",flat:"",icon:"done_all",onClick:e.removeUploadedFiles},{default:(0,o.w5)((()=>[(0,o.Wm)((0,n.SU)(r.Z),{msg:"Remove Uploaded Files"})])),_:2},1032,["onClick"])):(0,o.kq)("",!0),e.isUploading?((0,o.wg)(),(0,o.j4)(s,{key:2,class:"q-uploader__spinner"})):(0,o.kq)("",!0),(0,o._)("div",p,[m,(0,o._)("div",g,(0,i.zw)(e.uploadSizeLabel)+" / "+(0,i.zw)(e.uploadProgressLabel),1)]),e.canAddFiles?((0,o.wg)(),(0,o.j4)(t,{key:3,round:"",dense:"",flat:"",type:"a",icon:"add_box",onClick:e.pickFiles},{default:(0,o.w5)((()=>[(0,o.Wm)(c),(0,o.Wm)((0,n.SU)(r.Z),{msg:"Pick Files"})])),_:2},1032,["onClick"])):(0,o.kq)("",!0),e.canUpload?((0,o.wg)(),(0,o.j4)(t,{key:4,round:"",dense:"",flat:"",icon:"cloud_upload",onClick:e.upload},{default:(0,o.w5)((()=>[(0,o.Wm)((0,n.SU)(r.Z),{msg:"Upload Files"})])),_:2},1032,["onClick"])):(0,o.kq)("",!0),e.isUploading?((0,o.wg)(),(0,o.j4)(t,{key:5,round:"",dense:"",flat:"",icon:"clear",onClick:e.abort},{default:(0,o.w5)((()=>[(0,o.Wm)((0,n.SU)(r.Z),{msg:"Abrot Upload"})])),_:2},1032,["onClick"])):(0,o.kq)("",!0),(0,o.Wm)(t,{dense:"",round:"",flat:"",color:"blue-grey-2",icon:"close",onClick:(0,n.SU)(d)},{default:(0,o.w5)((()=>[(0,o.Wm)((0,n.SU)(r.Z),{msg:"Close"})])),_:1},8,["onClick"])])])),_:1},8,["field-name"])])),_:1},512)}}};var w=a(1639),_=a(3706),k=a(5918),q=a(4455),C=a(3940),Z=a(6246),v=a(9984),W=a.n(v);const b=(0,w.Z)(f,[["__scopeId","data-v-0cfa3fbc"]]),y=b;W()(f,"components",{QDialog:_.Z,QUploader:k.Z,QBtn:q.Z,QSpinner:C.Z,QUploaderAddTrigger:Z.Z});const U=(0,n.iH)([]),S=(0,n.iH)(""),Q=[{name:"name",label:"Name",field:"name",align:"center",sortable:!0},{name:"type",label:"Type",field:"type",align:"center",sortable:!0},{name:"size",label:"Size",field:"size",align:"center",sortable:!0},{name:"actions",label:"Actions",align:"center"}],h=async()=>{const e=await c.api.get("/files");return U.value=e.data.files,S.value=e.data.defaultpath,e},z={class:"row justify-between"},F={class:"row no-wrap items-center q-gutter-x-sm"},x=(0,o._)("div",null,"Local Files",-1),D={__name:"FilesHeader",setup(e){const l=(0,t.Z)(),a=()=>{l.dialog({component:y}).onOk((()=>{h()}))};return(e,l)=>{const t=(0,o.up)("q-icon"),i=(0,o.up)("q-btn");return(0,o.wg)(),(0,o.iD)("div",z,[(0,o._)("div",F,[(0,o.Wm)(t,{color:"yellow-8",size:"sm",name:"folder"}),x]),(0,o._)("div",null,[(0,o.Wm)(i,{flat:"",round:"",color:"primary",icon:"cloud_uploadf",onClick:a},{default:(0,o.w5)((()=>[(0,o.Wm)((0,n.SU)(r.Z),{msg:"Upload Files"})])),_:1})])])}}};var j=a(2857);const R=D,A=R;W()(D,"components",{QIcon:j.Z,QBtn:q.Z});var P=a(321);const T={class:"q-px-sm row no-wrap items-center"},O=(0,o._)("div",{style:{"font-size":"1rem"}},"Delete File",-1),B={class:"q-px-sm"},I={class:"q-px-sm"},L={__name:"deleteFile",props:{current:String},emits:[...s.Z.emits],setup(e,{emit:l}){const{dialogRef:a,onDialogCancel:t,onDialogOK:r}=(0,s.Z)();return(l,s)=>{const c=(0,o.up)("q-icon"),d=(0,o.up)("q-card-section"),u=(0,o.up)("q-btn"),p=(0,o.up)("q-card-actions"),m=(0,o.up)("q-card"),g=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(g,{ref_key:"dialogRef",ref:a},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{class:"q-dialog-plugin"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o._)("div",T,[(0,o.Wm)(c,{name:"delete",size:"20px",color:"red-10"}),O])])),_:1}),(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o._)("div",B,[(0,o._)("div",null,(0,i.zw)(e.current),1)])])),_:1}),(0,o.Wm)(p,{align:"right"},{default:(0,o.w5)((()=>[(0,o._)("div",I,[(0,o.Wm)(u,{round:"",flat:"",color:"red-10",icon:"cancel",onClick:(0,n.SU)(t)},null,8,["onClick"]),(0,o.Wm)(u,{round:"",flat:"",color:"primary",icon:"check_circle",onClick:(0,n.SU)(r)},null,8,["onClick"])])])),_:1})])),_:1})])),_:1},512)}}};var H=a(4458),K=a(3190),N=a(1821);const V=L,$=V;W()(L,"components",{QDialog:_.Z,QCard:H.Z,QCardSection:K.Z,QIcon:j.Z,QCardActions:N.Z,QBtn:q.Z});const G=(0,o._)("div",{class:"q-px-sm"},[(0,o._)("div",null,"Rename file")],-1),M={class:"q-px-sm"},E={class:"q-px-sm"},J={__name:"renameFile",props:{current:Number},emits:[...s.Z.emits],setup(e,{emit:l}){const a=e,{dialogRef:t,onDialogCancel:i,onDialogOK:r}=(0,s.Z)(),c=(0,n.iH)("");return(0,o.bv)((()=>{c.value=a.current})),(e,l)=>{const a=(0,o.up)("q-card-section"),s=(0,o.up)("q-input"),d=(0,o.up)("q-btn"),u=(0,o.up)("q-card-actions"),p=(0,o.up)("q-card"),m=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(m,{ref_key:"dialogRef",ref:t},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{class:"q-dialog-plugin"},{default:(0,o.w5)((()=>[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[G])),_:1}),(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o._)("div",M,[(0,o.Wm)(s,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=e=>c.value=e),dense:"",outlined:"",label:"Name"},null,8,["modelValue"])])])),_:1}),(0,o.Wm)(u,{align:"right"},{default:(0,o.w5)((()=>[(0,o._)("div",E,[(0,o.Wm)(d,{round:"",flat:"",color:"red-10",icon:"cancel",onClick:(0,n.SU)(i)},null,8,["onClick"]),(0,o.Wm)(d,{round:"",flat:"",color:"primary",icon:"check_circle",onClick:l[1]||(l[1]=e=>(0,n.SU)(r)(c.value))})])])),_:1})])),_:1})])),_:1},512)}}};var X=a(6611);const Y=J,ee=Y;W()(J,"components",{QDialog:_.Z,QCard:H.Z,QCardSection:K.Z,QInput:X.Z,QCardActions:N.Z,QBtn:q.Z});var le=a(3910);const ae={class:"q-gutter-x-sm"},oe={__name:"FilesList",setup(e){const l=(0,t.Z)(),{humanStorageSize:a}=P["default"],s=e=>{l.dialog({component:$,componentProps:{current:e.base}}).onOk((async()=>{try{l.loading.show();const a=await c.api.delete("/files",{params:{...e}});console.log(a),await h(),l.loading.hide()}catch(a){l.loading.hide(),console.error(a)}}))},d=e=>{l.dialog({component:ee,componentProps:{current:e.base}}).onOk((async a=>{try{l.loading.show();const o=await c.api.post("/files/rename",{...e,newname:a});console.log(o),await h(),l.loading.hide()}catch(o){l.loading.hide(),console.error(o)}}))};return(e,l)=>{const t=(0,o.up)("q-td"),c=(0,o.up)("q-btn"),u=(0,o.up)("q-tr"),p=(0,o.up)("q-table");return(0,o.wg)(),(0,o.j4)(p,{"table-header-class":"bg-grey-3",rows:(0,n.SU)(U),columns:(0,n.SU)(Q),pagination:{rowsPerPage:0},"hide-pagination":"","wrap-cells":""},{body:(0,o.w5)((e=>[(0,o.Wm)(u,{props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(t,{key:"name",props:e},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.row.name),1)])),_:2},1032,["props"]),(0,o.Wm)(t,{key:"type",props:e},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)(e.row.ext.substring(1).toUpperCase()),1)])),_:2},1032,["props"]),(0,o.Wm)(t,{key:"size",props:e},{default:(0,o.w5)((()=>[(0,o.Uk)((0,i.zw)((0,n.SU)(a)(e.row.size)),1)])),_:2},1032,["props"]),(0,o.Wm)(t,{key:"actions",props:e},{default:(0,o.w5)((()=>[(0,o._)("div",ae,[(0,o.Wm)(c,{round:"",flat:"",icon:"input",size:"sm",color:"primary",onClick:l=>(0,n.SU)(le.GM)(e.row)},{default:(0,o.w5)((()=>[(0,o.Wm)((0,n.SU)(r.Z),{msg:"Load"})])),_:2},1032,["onClick"]),(0,o.Wm)(c,{round:"",flat:"",icon:"edit",size:"sm",color:"primary",onClick:l=>d(e.row)},{default:(0,o.w5)((()=>[(0,o.Wm)((0,n.SU)(r.Z),{msg:"Rename"})])),_:2},1032,["onClick"]),(0,o.Wm)(c,{round:"",flat:"",icon:"delete",size:"sm",color:"red",onClick:l=>s(e.row)},{default:(0,o.w5)((()=>[(0,o.Wm)((0,n.SU)(r.Z),{msg:"Delete"})])),_:2},1032,["onClick"])])])),_:2},1032,["props"])])),_:2},1032,["props"])])),_:1},8,["rows","columns"])}}};var ne=a(7580),te=a(3532),ie=a(7220);const se=oe,re=se;W()(oe,"components",{QTable:ne.Z,QTr:te.Z,QTd:ie.Z,QBtn:q.Z});const ce={class:"q-pa-md"},de={__name:"FilesPage",setup(e){return(0,o.wF)((async()=>{await h()})),(e,l)=>{const a=(0,o.up)("q-card-section"),t=(0,o.up)("q-card");return(0,o.wg)(),(0,o.iD)("div",ce,[(0,o.Wm)(t,{class:"bg-grey-1",flat:""},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{class:"q-pb-none q-mb-none"},{default:(0,o.w5)((()=>[(0,o.Wm)((0,n.SU)(A))])),_:1}),(0,o.Wm)(a,{class:"q-pt-xs q-mt-none"},{default:(0,o.w5)((()=>[(0,o.Wm)((0,n.SU)(re),{class:"gt-xs"})])),_:1})])),_:1})])}}},ue=de,pe=ue;W()(de,"components",{QCard:H.Z,QCardSection:K.Z})}}]);